# morgens an per Zeit
  - alias: 'Beleuchtung morgens an'
    initial_state: 'on'
    trigger:
      platform: time
      minutes: '/1'
      seconds: 0
    condition:
      condition: and
      conditions:
        - condition: template
          value_template: '{{ states.sensor.time.state == (states.input_datetime.beleuchtung_morgens_an.attributes.timestamp | int | timestamp_custom("%H:%M", False)) }}'
        - condition: or
          conditions:
            - condition: state
              entity_id: input_select.zeitsteuerung
              state: 'Zeit und Sonne'
            - condition: state
              entity_id: input_select.zeitsteuerung
              state: 'Zeit'
        - condition: time 
          weekday:
            - mon
            - tue
            - wed
            - thu
            - fri
    action:
      - service: switch.turn_on
        data:
          entity_id: switch.s20_3

# morgens aus per Zeit
  - alias: 'Beleuchtung morgens aus'
    initial_state: 'on'
    trigger:
      platform: time
      minutes: '/1'
      seconds: 0
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: input_select.zeitsteuerung
          state: 'Zeit'
        - condition: template
          value_template: '{{ states.sensor.time.state == (states.input_datetime.beleuchtung_morgens_aus.attributes.timestamp | int | timestamp_custom("%H:%M", False)) }}'
        - condition: time 
          weekday:
            - mon
            - tue
            - wed
            - thu
            - fri
    action:
      - service: switch.turn_off
        data:
          entity_id: switch.s20_3

# abends an per Zeit
  - alias: 'Beleuchtung abends an'
    initial_state: 'on'
    trigger:
      platform: time
      minutes: '/1'
      seconds: 0
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: input_select.zeitsteuerung
          state: 'Zeit'
        - condition: template
          value_template: '{{ states.sensor.time.state == (states.input_datetime.beleuchtung_abends_an.attributes.timestamp | int | timestamp_custom("%H:%M", False)) }}'
        - condition: time 
          weekday:
            - mon
            - tue
            - wed
            - thu
            - fri
    action:
      - service: switch.turn_on
        data:
          entity_id: switch.s20_3

# abends aus per Zeit
  - alias: 'Beleuchtung abends aus'
    initial_state: 'on'
    trigger:
      platform: time
      minutes: '/1'
      seconds: 0
    condition:
      condition: and
      conditions:
        - condition: template
          value_template: '{{ states.sensor.time.state == (states.input_datetime.beleuchtung_abends_aus.attributes.timestamp | int | timestamp_custom("%H:%M", False)) }}'
        - condition: or
          conditions:
            - condition: state
              entity_id: input_select.zeitsteuerung
              state: 'Zeit und Sonne'
            - condition: state
              entity_id: input_select.zeitsteuerung
              state: 'Zeit'
        - condition: time 
          weekday:
            - mon
            - tue
            - wed
            - thu
            - fri
    action:
      - service: switch.turn_off
        data:
          entity_id: switch.s20_3

# aus nach Sonnenaufgang
  - alias: 'Beleuchtung aus nach Sonnenaufgang'
    initial_state: 'on'
    trigger:
      platform: sun
      event: sunrise
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: input_select.zeitsteuerung
          state: 'Zeit und Sonne'
        - condition: time 
          weekday:
            - mon
            - tue
            - wed
            - thu
            - fri
    action:
      - service: switch.turn_off
        entity_id: switch.s20_3

# an vor Sonnenuntergang
  - alias: 'Beleuchtung an vor Sonnenuntergang'
    initial_state: 'on'
    trigger:
      platform: sun
      event: sunset
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: input_select.zeitsteuerung
          state: 'Zeit und Sonne'
        - condition: time 
          weekday:
            - mon
            - tue
            - wed
            - thu
            - fri
    action:
      service: switch.turn_on
      entity_id: switch.s20_3